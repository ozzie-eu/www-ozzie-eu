<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>ORM vs. Raw SQL: A Performance Showdown :: Ozzie.eu</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="In the realm of data access, the choice between Object-Relational Mappers (ORMs) like Entity Framework (EF) Core and direct SQL approaches like Dapper can significantly impact application performance. This post delves into the nuances of each and explore a comparative analysis using .NET code examples." />
<meta name="keywords" content="joao,osorio,ozzie,blog" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/post/orm-vs-raw-sql/" />


  





  
  <link rel="stylesheet" href="/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ORM vs. Raw SQL: A Performance Showdown">
<meta property="og:description" content="In the realm of data access, the choice between Object-Relational Mappers (ORMs) like Entity Framework (EF) Core and direct SQL approaches like Dapper can significantly impact application performance. This post delves into the nuances of each and explore a comparative analysis using .NET code examples." />
<meta property="og:url" content="/post/orm-vs-raw-sql/" />
<meta property="og:site_name" content="Ozzie.eu" />

  <meta property="og:image" content="/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="backend" />

  <meta property="article:section" content="Database" />


  <meta property="article:published_time" content="2024-10-29 12:38:26 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Ozzie.eu
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/">Home</a></li>
        
      
        
          <li><a href="/post">All Posts</a></li>
        
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/tags">Tags</a></li>
        
      
        
          <li><a href="/categories">Categories</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/" >Home</a></li>
        
      
        
          <li><a href="/post" >All Posts</a></li>
        
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/tags" >Tags</a></li>
        
      
        
          <li><a href="/categories" >Categories</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/post/orm-vs-raw-sql/">ORM vs. Raw SQL: A Performance Showdown</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-10-29</time></div>

  
    <span class="post-tags">
      
      #<a href="/tags/sqlserver/">sqlserver</a>&nbsp;
      
      #<a href="/tags/dotnetcore/">dotnetcore</a>&nbsp;
      
      #<a href="/tags/c#/">C#</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p><strong>ORM vs. Raw SQL: A Performance Showdown with Northwind Traders</strong></p>
<p>In the realm of data access, the choice between Object-Relational Mappers (ORMs) like Entity Framework (EF) Core and direct SQL approaches like Dapper can significantly impact application performance. Let&rsquo;s delve into the nuances of each and explore a comparative analysis using .NET code examples, benchmarking their performance against the classic Northwind Traders database.</p>
<p><strong>Understanding the Contenders</strong></p>
<ul>
<li>
<p><strong>ORM (Entity Framework Core):</strong></p>
<ul>
<li>High-level abstraction: Maps object-oriented entities to database tables.</li>
<li>Reduced boilerplate code: Simplifies data access operations.</li>
<li>Automatic query generation: Generates SQL queries based on LINQ expressions.</li>
<li>Potential performance overhead: Due to the abstraction layer and query generation.</li>
</ul>
</li>
<li>
<p><strong>Raw SQL (Dapper):</strong></p>
<ul>
<li>Low-level approach: Requires manual SQL query writing.</li>
<li>Enhanced performance: Direct execution of optimized SQL queries.</li>
<li>Greater flexibility: Fine-grained control over query execution.</li>
<li>Increased development effort: More manual coding and potential for SQL injection vulnerabilities.</li>
</ul>
</li>
</ul>
<p><strong>Performance Benchmarking with Northwind Traders</strong></p>
<p>To illustrate the performance differences, let&rsquo;s consider a benchmark scenario: retrieving a list of orders with their associated customer and order details.</p>
<p><strong>EF Core Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Data.SqlClient</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">static</span> <span class="kd">async</span> <span class="n">Task</span> <span class="n">BenchmarkEFCore</span><span class="p">(</span><span class="n">WideWorldImportersContext</span> <span class="n">context</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">stopwatch</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stopwatch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">stopwatch</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Orders</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">Include</span><span class="p">(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Customer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">Include</span><span class="p">(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">OrderLines</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">ToListAsync</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">stopwatch</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;EF Core execution time: {stopwatch.ElapsedMilliseconds} ms&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Dapper Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Dapper</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">static</span> <span class="kd">async</span> <span class="n">Task</span> <span class="n">BenchmarkDapper</span><span class="p">(</span><span class="n">SqlConnection</span> <span class="n">connection</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">stopwatch</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stopwatch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">stopwatch</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">sql</span> <span class="p">=</span> <span class="s">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">        SELECT o.*, c.*, ol.*
</span></span></span><span class="line"><span class="cl"><span class="s">        FROM Sales.Orders o
</span></span></span><span class="line"><span class="cl"><span class="s">        INNER JOIN Sales.Customers c ON o.CustomerID = c.CustomerID
</span></span></span><span class="line"><span class="cl"><span class="s">        INNER JOIN Sales.OrderLines ol ON o.OrderID = ol.OrderID&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="p">(</span><span class="k">await</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryAsync</span><span class="p">&lt;</span><span class="n">Orders</span><span class="p">,</span> <span class="n">Customers</span><span class="p">,</span> <span class="n">OrderLines</span><span class="p">,</span> <span class="n">Orders</span><span class="p">&gt;(</span><span class="n">sql</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ol</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">o</span><span class="p">.</span><span class="n">Customer</span> <span class="p">=</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">o</span><span class="p">.</span><span class="n">OrderLines</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">ol</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">o</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span> <span class="n">splitOn</span><span class="p">:</span> <span class="s">&#34;CustomerID, OrderID&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">stopwatch</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Dapper execution time: {stopwatch.ElapsedMilliseconds} ms&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Key Performance Factors:</strong></p>
<p>The output of the full program will be similar to this one:</p>
<pre tabindex="0"><code>EF Core execution time: 3535 ms
Dapper execution time: 1322 ms
</code></pre><p>No matter how many time you execute the program, the order of difference between these two data retrievals will be the same. Dapper takes a little over 1/3 of the time spent by EF Core. However, if you change the program to repeat consecutively the same exact data retrieval, EF Core will start to have a better performance time than Dapper. This is because EF uses caching and change tracking.</p>
<ol>
<li>
<p><strong>Query Complexity:</strong></p>
<ul>
<li><strong>Simple Queries:</strong> For straightforward queries, EF Core can often perform comparably to Dapper.</li>
<li><strong>Complex Queries:</strong> Dapper excels in handling complex queries with joins, aggregations, and custom SQL functions, as it allows for precise optimization.</li>
</ul>
</li>
<li>
<p><strong>Data Volume:</strong></p>
<ul>
<li><strong>Small Datasets:</strong> EF Core&rsquo;s overhead might be negligible.</li>
<li><strong>Large Datasets:</strong> Dapper can significantly outperform EF Core, especially when dealing with massive data volumes.</li>
</ul>
</li>
<li>
<p><strong>Application Architecture:</strong></p>
<ul>
<li><strong>Micro-services:</strong> Dapper&rsquo;s flexibility and lightweight nature can be advantageous in micro-service architectures.</li>
<li><strong>Monolithic Applications:</strong> EF Core&rsquo;s abstraction layer can simplify development in monolithic applications.</li>
</ul>
</li>
</ol>
<p><strong>Balancing Performance and Productivity</strong></p>
<p>The optimal approach often lies in a hybrid strategy:</p>
<ul>
<li><strong>Leverage ORM for Rapid Development:</strong> Use EF Core for simple CRUD operations and rapid prototyping.</li>
<li><strong>Employ Raw SQL for Performance-Critical Scenarios:</strong> Utilize Dapper for complex queries, large data sets, and performance-sensitive operations.</li>
</ul>
<p><strong>Conclusion</strong></p>
<p>The choice between ORM and raw SQL is a trade-off between developer productivity and application performance. By carefully considering the specific requirements of your application, you can select the most appropriate approach to optimize both development time and execution speed. Remember to benchmark your specific use cases to make informed decisions.</p>
<p>If you&rsquo;d like to try the benchmark yourself and reach to your own conclusions, the full C# program for this benchmark is available <a href="https://gist.github.com/ozzie-eu/6af55841cd34c44d894b4e0b469e298f">here</a>.</p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="/post/dotnet-cross-platform-mirage/" class="button inline prev">
        &lt; [<span class="button__text">The Cross-Platform Mirage: .NET and the Windows Dependency Trap</span>]
      </a>
    
    
      ::
    
    
      <a href="/post/deleted-dotnet-ef-core-migration-history/" class="button inline next">
         [<span class="button__text">Recover deleted .net EF Core Migration History Table</span>] &gt;
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
